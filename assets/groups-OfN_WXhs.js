var b=Object.defineProperty;var w=(s,t,e)=>t in s?b(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var i=(s,t,e)=>w(s,typeof t!="symbol"?t+"":t,e);import{U as n,s as d,b as y,a as p,c as j,F as k,d as g,u as E,p as v}from"./useUser-Bw_ovCZR.js";class G{constructor(){i(this,"selectors",{root:"[data-js-theme]",body:"[data-js-theme-body]",btn:"[data-js-theme-btn]"});i(this,"classes",{isLight:"is-light",isDark:"is-dark"});this.themeElement=$(this.selectors.root),this.themeBodyElement=this.themeElement.find(this.selectors.body),this.themeBtnElement=this.themeBodyElement.find(this.selectors.btn),this.theme="light",this.loadFunctions(),this.bindEvents()}loadFunctions(){this.theme=window.localStorage.getItem("theme")??"light",this.changeTheme(this.theme)}bindEvents(){this.themeBodyElement.on("click",this.clickToTheme.bind(this))}clickToTheme(){this.themeBtnElement.hasClass(this.classes.isLight)?this.changeTheme("dark"):this.changeTheme("light")}changeTheme(t){t==="light"?this.setClassToBtn(this.classes.isDark,this.classes.isLight):this.setClassToBtn(this.classes.isLight,this.classes.isDark),this.setClassToBody(t),this.setToLocStore(t)}setClassToBtn(t,e){this.themeBtnElement.removeClass(t),this.themeBtnElement.addClass(e)}setClassToBody(t){t==="light"?$(document.body).removeClass(this.classes.isDark):$(document.body).addClass(this.classes.isDark)}setToLocStore(t){window.localStorage.setItem("theme",t)}}class T{constructor(){i(this,"selectors",{root:"[data-js-animation]",body:"[data-js-animation-body]",btn:"[data-js-animation-btn]"});i(this,"classes",{isActive:"is-active"});this.animationElement=$(this.selectors.root),this.animationBodyElement=this.animationElement.find(this.selectors.body),this.animationBtnElement=this.animationElement.find(this.selectors.btn),this.animation=!0,this.loadFunctions(),this.bindEvents()}loadFunctions(){this.animation=window.localStorage.getItem("animation")==="true",this.changeAnimation(this.animation)}bindEvents(){this.animationBodyElement.on("click",this.clickToAnimation.bind(this))}clickToAnimation(){this.animationBtnElement.hasClass(this.classes.isActive)?this.changeAnimation(!1):this.changeAnimation(!0)}changeAnimation(t){jQuery.fx.off=!t,this.setClassToBtn(t),this.setToLocStore(t)}setClassToBtn(t){t?this.animationBtnElement.addClass(this.classes.isActive):this.animationBtnElement.removeClass(this.classes.isActive)}setToLocStore(t){window.localStorage.setItem("animation",t)}}class L{constructor(){i(this,"selectors",{settings:"[data-js-settings]",open:"[data-js-settings-open]",close:"[data-js-settings-close]"});this.settingsElement=$(this.selectors.settings),this.settingsOpenBtn=$(this.selectors.open),this.settingsCloseBtn=$(this.selectors.close),this.bindEvents()}bindEvents(){this.settingsOpenBtn.on("click",this.openSettingsBlock.bind(this)),this.settingsCloseBtn.on("click",this.closeSettingsBlock.bind(this))}openSettingsBlock(){this.settingsElement.animate({opacity:1,scale:1},150,function(){$(this).css("border-radius","0")})}closeSettingsBlock(){this.settingsElement.animate({opacity:0,scale:0},150)}}function u(s,t){t.text($(s.target).val().length)}const h={form:"[data-js-form]",redactBtn:"[data-js-redact-btn]"};function m(s,t){let{target:e}=s;if(I(e)){let r=e.closest(h==null?void 0:h.form),l=r.querySelector(h==null?void 0:h.redactBtn),f=r.querySelectorAll("input"),B=U(t,f),C=A(f);l.disabled=!C||B}}function I(s){return s.tagName==="INPUT"}function U(s,t){let e=0,o=t.length;return t.forEach((r,l)=>{r.value===s[l]&&e++}),e===o}function A(s){let t=[];return s.forEach(e=>t.push(e.value)),t.every(e=>e.length)}class S{constructor(){i(this,"selectors",{user:"[data-js-user]",content:"[data-js-user-content]",form:"[data-js-user-form]",loading:"[data-js-user-loading]",open:"[data-js-user-open]",close:"[data-js-user-close]",redact:"[data-js-user-redact-btn]",exit:"[data-js-user-exit]",delete:"[data-js-user-delete]",organizationInput:"[data-js-user-organization]",organizationCounter:"[data-js-user-organization-counter]",loginInput:"[data-js-user-login]",loginCounter:"[data-js-user-login-counter]",passwordInput:"[data-js-user-password]",passwordCounter:"[data-js-user-password-counter]"});i(this,"classes",{isActive:"is-active"});i(this,"redact",async()=>{try{if(d(this.redactBtn,this.loadingElement),await this.user.checkDoubleLogin(this.loginInputElement.val())){let e={id:n.activeUser.id,login:this.loginInputElement.val(),password:this.passwordInputElement.val(),organization:this.organizationInputElement.val()};(await y(e)).status===200?(n.activeUser=e,this.user.setToLocalStorage(),p("Пользователь изменен!!"),this.redactBtn.attr("disabled",!1),this.closeBlock()):alert("Что-то пошло не так..")}else alert("Пользователь с таким логином уже существует!!")}catch{alert("Что-то пошло не так..")}finally{d(this.redactBtn,this.loadingElement)}});i(this,"delete",async()=>{try{let t={params:{id:n.activeUser.id}};(await j(t)).status===200?(p("Пользователь удален!!"),setTimeout(()=>{this.user.becomeToAuthorization()},1e3)):alert("Что-то пошло не так..")}catch{alert("Что-то пошло не так..")}});this.user=new n,this.userElement=$(this.selectors.user),this.userContentElement=this.userElement.find(this.selectors.content),this.formElement=this.userElement.find(this.selectors.form),this.loadingElement=this.userElement.find(this.selectors.loading),this.openBtn=$(this.selectors.open),this.closeBtn=this.userElement.find(this.selectors.close),this.redactBtn=this.userElement.find(this.selectors.redact),this.exitBtn=this.userElement.find(this.selectors.exit),this.deleteBtn=this.userElement.find(this.selectors.delete),this.organizationInputElement=$(this.formElement).find(this.selectors.organizationInput),this.organizationCounterElement=$(this.formElement).find(this.selectors.organizationCounter),this.loginInputElement=$(this.formElement).find(this.selectors.loginInput),this.loginCounterElement=$(this.formElement).find(this.selectors.loginCounter),this.passwordInputElement=$(this.formElement).find(this.selectors.passwordInput),this.passwordCounterElement=$(this.formElement).find(this.selectors.passwordCounter),this.loadFunctions(),this.bindEvents()}loadFunctions(){this.setUserInfo(),this.setUserCounter(),this.redactBtn.attr("disabled",!0)}bindEvents(){this.openBtn.on("click",this.openBlock.bind(this)),this.closeBtn.on("click",this.closeBlock.bind(this)),this.organizationInputElement.on("input",t=>{u(t,this.organizationCounterElement),m(t,[n.activeUser.organization,n.activeUser.login,n.activeUser.password])}),this.loginInputElement.on("input",t=>{u(t,this.loginCounterElement),m(t,[n.activeUser.organization,n.activeUser.login,n.activeUser.password])}),this.passwordInputElement.on("input",t=>{u(t,this.passwordCounterElement),m(t,[n.activeUser.organization,n.activeUser.login,n.activeUser.password])}),this.redactBtn.on("click",this.clickToRedact.bind(this)),this.exitBtn.on("click",this.clickToExit.bind(this)),this.deleteBtn.on("click",this.clickToDelete.bind(this))}setUserInfo(){this.organizationInputElement.val(n.activeUser.organization),this.loginInputElement.val(n.activeUser.login),this.passwordInputElement.val(n.activeUser.password)}setUserCounter(){this.organizationCounterElement.text(this.organizationInputElement.val().length),this.loginCounterElement.text(this.loginInputElement.val().length),this.passwordCounterElement.text(this.passwordInputElement.val().length)}openBlock(){this.userElement.addClass(this.classes.isActive),this.userContentElement.animate({top:"50%"},250)}closeBlock(){this.userContentElement.animate({top:"-100%"},200,()=>{this.userElement.removeClass(this.classes.isActive)})}clickToRedact(){new k().onSubmit(this.formElement)&&confirm("Вы действительно хотите редактировать профиль?")&&this.redact()}clickToExit(){confirm("Вы действительно хотите выйти?")&&this.user.becomeToAuthorization()}clickToDelete(){confirm("Вы действительно хотите удалить профиль?")&&this.delete()}}function z(s){return g.get(`${E}/student_group/getStudentsGroups.php${s}`)}function x(s){return g.get(`${E}/student_group/checkStudentGroup.php${s}`)}function V(s){return g.post(`${E}/student_group/createStudentGroup.php`,s,{headers:{"Content-Type":"application/json"}})}function F(s){return g.delete(`${E}/student_group/deleteStudentGroup.php`,s)}function _(s){return g.patch(`${E}/student_group/updateStudentGroup.php`,s,{headers:{"Content-Type":"application/json"}})}class D extends n{constructor(){super();i(this,"checkGroup",async(e="",o="")=>{try{let r=`?user_id=${n.activeUser.id}&id=${e}&name=${o}`;const l=await x(r);if(l.status===200)return!l.data.length;alert("Что-то пошло не так..")}catch{alert("Что-то пошло не так..")}});this.activeGroup={}}}const c=class c{constructor(){i(this,"selectors",{list:"[data-js-groups-list]",empty:"[data-js-groups-list-empty]"});i(this,"classes",{isActive:"is-active"});i(this,"checkDoubleName",t=>c.groupsList.length?!c.groupsList.some(e=>e.name===t):!0);this.listElement=$(this.selectors.list),this.emptyElement=$(this.selectors.empty)}setUserGroups(){let t=c.groupsList.map(o=>`
                    <li class="groups__item list__item">
                        <p class="h4">${o.name}</p>
                        <div class="list__btn-bar">
                            <button class="list-btn"
                                    type="button"
                                    aria-label="Редактировать группу"
                                    title="Редактировать группу"
                                    data-js-groups-redact-open
                            >
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M21.1213 2.70705C19.9497 1.53548 18.0503 1.53547 16.8787 2.70705L15.1989 4.38685L7.29289 12.2928C7.16473 12.421 7.07382 12.5816 7.02986 12.7574L6.02986 16.7574C5.94466 17.0982 6.04451 17.4587 6.29289 17.707C6.54127 17.9554 6.90176 18.0553 7.24254 17.9701L11.2425 16.9701C11.4184 16.9261 11.5789 16.8352 11.7071 16.707L19.5556 8.85857L21.2929 7.12126C22.4645 5.94969 22.4645 4.05019 21.2929 2.87862L21.1213 2.70705ZM18.2929 4.12126C18.6834 3.73074 19.3166 3.73074 19.7071 4.12126L19.8787 4.29283C20.2692 4.68336 20.2692 5.31653 19.8787 5.70705L18.8622 6.72357L17.3068 5.10738L18.2929 4.12126ZM15.8923 6.52185L17.4477 8.13804L10.4888 15.097L8.37437 15.6256L8.90296 13.5112L15.8923 6.52185ZM4 7.99994C4 7.44766 4.44772 6.99994 5 6.99994H10C10.5523 6.99994 11 6.55223 11 5.99994C11 5.44766 10.5523 4.99994 10 4.99994H5C3.34315 4.99994 2 6.34309 2 7.99994V18.9999C2 20.6568 3.34315 21.9999 5 21.9999H16C17.6569 21.9999 19 20.6568 19 18.9999V13.9999C19 13.4477 18.5523 12.9999 18 12.9999C17.4477 12.9999 17 13.4477 17 13.9999V18.9999C17 19.5522 16.5523 19.9999 16 19.9999H5C4.44772 19.9999 4 19.5522 4 18.9999V7.99994Z" fill="#000000"/>
                                </svg>
                            </button>
                            <button class="list-btn"
                                    type="button"
                                    aria-label="Удалить группу"
                                    title="Удалить группу"
                                    data-js-groups-delete
                            >
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M4 7H20" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M6 7V18C6 19.6569 7.34315 21 9 21H15C16.6569 21 18 19.6569 18 18V7" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </li>
            `).join(""),e=$('<ul class="groups__list list list--padding"></ul>');e.html(t),this.listElement.html(e),$(document).trigger("groupsListRendered")}setEmptyGroups(){this.emptyElement.toggleClass(this.classes.isActive)}};i(c,"groupsList",[]),i(c,"activeGroup",{});let a=c;class R{constructor(){i(this,"selectors",{root:"[data-js-create-group]",open:"[data-js-create-group-open]",close:"[data-js-create-group-close]",input:"[data-js-create-group-input]",counter:"[data-js-create-group-counter]",create:"[data-js-create-group-create]",loading:"[data-js-create-group-loading]"});i(this,"classes",{isActive:"is-active"});i(this,"create",async()=>{try{d(this.createBtn,this.loadingElement);let t=this.useGroups.checkDoubleName(this.inputElement.val()),e=await this.groups.checkGroup("",this.inputElement.val());if(t&&e){let o={user_id:n.activeUser.id,name:this.inputElement.val()};(await V(o)).status===200?(p("Группа добавлена!!"),setTimeout(()=>{location.reload()},1e3)):alert("Что-то пошло не так..")}else alert("Такая группа уже существует!!")}catch{alert("Что-то пошло не так..")}finally{d(this.createBtn,this.loadingElement)}});this.groups=new D,this.useGroups=new a,this.user=new n,this.createGroupElement=$(this.selectors.root),this.openBtn=$(this.selectors.open),this.closeBtn=this.createGroupElement.find(this.selectors.close),this.inputElement=this.createGroupElement.find(this.selectors.input),this.counterElement=this.createGroupElement.find(this.selectors.counter),this.createBtn=this.createGroupElement.find(this.selectors.create),this.loadingElement=this.createGroupElement.find(this.selectors.loading),this.loadFunctions(),this.bindEvents()}loadFunctions(){this.clearInfo()}bindEvents(){this.openBtn.on("click",this.openBlock.bind(this)),this.closeBtn.on("click",this.closeBlock.bind(this)),this.inputElement.on("input",t=>{u(t,this.counterElement),m(t,[""])}),this.createBtn.on("click",this.clickToCreate.bind(this))}clearInfo(){this.inputElement.val(""),this.counterElement.text(0)}openBlock(){this.createGroupElement.addClass(this.classes.isActive),this.createGroupElement.animate({opacity:1,scale:1},150,function(){$(this).css("border-radius","0")})}closeBlock(){this.createGroupElement.animate({opacity:0,scale:0},150,()=>{this.createGroupElement.removeClass(this.classes.isActive),this.clearInfo()})}clickToCreate(){confirm("Вы действительно хотите создать группу?")&&this.create()}}class N{constructor(){i(this,"selectors",{root:"[data-js-groups]",list:"[data-js-groups-list]",name:"[data-js-groups-name]",loading:"[data-js-groups-list-loading]",empty:"[data-js-groups-list-empty]",delete:"[data-js-groups-delete]"});i(this,"classes",{isActive:"is-active"});i(this,"loadFunctions",async()=>{this.setUserOrganizationName(),await this.getGroups(),this.bindEvents()});i(this,"getGroups",async()=>{try{this.loadingElement.addClass(this.classes.isActive);let t=`?user_id=${n.activeUser.id}`;const e=await z(t);e.status===200?(a.groupsList=e.data,e.data.length?this.useGroups.setUserGroups():this.useGroups.setEmptyGroups()):alert("Что-то пошло не так..")}catch(t){console.log(t),alert("Что-то пошло не так..")}finally{this.loadingElement.removeClass(this.classes.isActive)}});i(this,"delete",async t=>{try{let e=a.groupsList[t].id,o={params:{user_id:n.activeUser.id,id:e}};(await F(o)).status===200?(a.groupsList=a.groupsList.filter(l=>l.id!==e),a.groupsList.length?this.useGroups.setUserGroups():this.useGroups.setEmptyGroups(),p("Группа удалена!!")):alert("Что-то пошло не так..")}catch{alert("Что-то пошло не так..")}});this.user=new n,this.useGroups=new a,this.groupsElement=$(this.selectors.root),this.listElement=this.groupsElement.find(this.selectors.list),this.nameElement=this.groupsElement.find(this.selectors.name),this.loadingElement=this.groupsElement.find(this.selectors.loading),this.emptyElement=this.groupsElement.find(this.selectors.empty),$(document).on("groupsListRendered",()=>{this.deleteBtns=this.groupsElement.find(this.selectors.delete)}),this.loadFunctions()}bindEvents(){this.deleteBtns.each((t,e)=>{$(e).on("click",()=>{confirm("Вы действительно хотите удалить группу?")&&this.delete(t)})})}setUserOrganizationName(){this.nameElement.text(n.activeUser.organization)}}class H{constructor(){i(this,"selectors",{root:"[data-js-groups-redact]",open:"[data-js-groups-redact-open]",close:"[data-js-groups-redact-close]",input:"[data-js-groups-redact-input]",counter:"[data-js-groups-redact-counter]",redact:"[data-js-groups-redact-btn]",loading:"[data-js-groups-redact-loading]"});i(this,"classes",{isActive:"is-active"});i(this,"loadFunctions",()=>{});i(this,"redact",async()=>{try{if(d(this.redactBtn,this.loadingElement),this.useGroups.checkDoubleName(this.inputElement.val())){let e={user_id:n.activeUser.id,id:a.activeGroup.id,name:this.inputElement.val()};(await _(e)).status===200?(p("Группа изменена!!"),setTimeout(()=>{location.reload()},1500)):alert("Что-то пошло не так..")}else alert("Такая группа уже существует!!")}catch{alert("Что-то пошло не так..")}finally{d(this.redactBtn,this.loadingElement)}});this.useGroups=new a,this.redactElement=$(this.selectors.root),this.closeBtn=this.redactElement.find(this.selectors.close),this.inputElement=this.redactElement.find(this.selectors.input),this.counterElement=this.redactElement.find(this.selectors.counter),this.redactBtn=this.redactElement.find(this.selectors.redact),this.loadingElement=this.redactElement.find(this.selectors.loading),this.coordinates={},$(document).on("groupsListRendered",()=>{this.openBtns=$(this.selectors.open),this.bindEvents()}),this.loadFunctions()}bindEvents(){this.openBtns.each((t,e)=>{$(e).on("click",()=>{this.setInfo(t),this.openBlock(e)})}),this.closeBtn.on("click",this.closeBlock.bind(this)),this.inputElement.on("input",t=>{u(t,this.counterElement),m(t,[a.activeGroup.name])}),this.redactBtn.on("click",this.clickToRedact.bind(this))}setInfo(t){a.activeGroup=a.groupsList[t];let e=a.activeGroup.name;this.inputElement.val(e),this.counterElement.text(e.length)}openBlock(t){this.redactElement.addClass(this.classes.isActive),this.coordinates=this.getCoordinates(t),this.redactElement.css({transformOrigin:`${v(this.coordinates.left)+1.5}rem ${v(this.coordinates.top)+1.5}rem`}),this.redactElement.animate({scale:1},150,function(){$(this).css("border-radius","0")})}getCoordinates(t){let e=t.getBoundingClientRect(),o=e.top,r=e.left;return{top:o,left:r}}closeBlock(){this.redactElement.animate({scale:0},150,()=>{this.redactElement.removeClass(this.classes.isActive)}),this.redactBtn.attr("disabled",!0)}clickToRedact(){confirm("Вы действительно хотите редактировать группу?")&&this.redact()}}new G;new T;new L;new k;new n().logInCheck();new S;new R;new N;new H;
